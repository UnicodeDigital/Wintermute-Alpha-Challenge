# a) Identify a set of DAOs that are most vulnerable to an economic governance attack, describe how it may be achieved, and estimate the cost to the attacker.


| DAO              | voter apathy<br />avg. votes in % of delegated vote | gov. token liquidity<br />avail. liquidity in % of proposal thresh | gov. token liquidity<br />avail. liquidity in % of avg. votes | large treasury<br />treasury value w/o gov. Token in % of delegated votes | configuration<br />proposal delay in blocks | configuration<br />voting period in blocks | configuration<br />timelock delay in blocks | centralization<br />minimum number of addresses holding more than 50% of the delegate votes |
| ---------------- | --------------------------------------------------- | ------------------------------------------------------------------ | ------------------------------------------------------------- | ------------------------------------------------------------------------- | ------------------------------------------- | ------------------------------------------ | ------------------------------------------- | ------------------------------------------------------------------------------------------- |
| Aave             | ``                                                  | 8.74                                                               | 4.53                                                          | ``                                                                        | 7,200                                       | 72,000                                     | ``                                          | 3                                                                                           |
| Ampleforth       | 81.13                                               | 93.55                                                              | 10.02                                                         | 508.76                                                                    | 13,140                                      | 19,710                                     | 172,800                                     | 3                                                                                           |
| ArbitrumCore     | ``                                                  | 1,595.42                                                           | 18.68                                                         | ``                                                                        | 21,600                                      | 100,800                                    | ``                                          | ``                                                                                          |
| ArbitrumTreasury | ``                                                  | 1,595.42                                                           | 22.19                                                         | ``                                                                        | 21,600                                      | 100,800                                    | ``                                          | ``                                                                                          |
| Babylon          | 32.07                                               | 52.68                                                              | 3.02                                                          | 0.00                                                                      | 1                                           | 45,818                                     | 86,400                                      | 4                                                                                           |
| Braintrust       | 75.93                                               | 182,186.84                                                         | 381.12                                                        | 0.00                                                                      | 1                                           | 17,280                                     | 604,800                                     | 1                                                                                           |
| Compound         | 22.19                                               | 300.00                                                             | 14.64                                                         | 0.94                                                                      | 13,140                                      | 19,710                                     | 172,800                                     | 12                                                                                          |
| Cryptex          | 48.02                                               | 0.01                                                               | 0.00                                                          | 1.06                                                                      | 1                                           | 172,800                                    | 259,200                                     | 3                                                                                           |
| Curve            | ``                                                  | ``                                                                 | 2.35                                                          | ``                                                                        | ``                                          | 604,800                                    | ``                                          | ``                                                                                          |
| ENS              | 33.91                                               | 124.80                                                             | 8.49                                                          | 10.21                                                                     | 1                                           | 45,818                                     | 172,800                                     | 17                                                                                          |
| Fei              | 18.78                                               | 399.22                                                             | 20.67                                                         | 0.00                                                                      | 1                                           | 13,000                                     | 86,400                                      | 14                                                                                          |
| Gas              | 54.85                                               | 116.82                                                             | 10.78                                                         | 0.00                                                                      | 1                                           | 45,818                                     | 0                                           | 2                                                                                           |
| Gitcoin          | 34.31                                               | 217.49                                                             | 11.17                                                         | 40.89                                                                     | 13,140                                      | 40,320                                     | 172,800                                     | 3                                                                                           |
| Hifi             | 51.80                                               | 216.31                                                             | 3.87                                                          | 0.00                                                                      | 13,140                                      | 36,000                                     | 172,800                                     | 4                                                                                           |
| Hop              | 24.07                                               | 361.06                                                             | 85.17                                                         | 0.00                                                                      | 1                                           | 45,818                                     | 172,800                                     | 7                                                                                           |
| Idle             | 24.82                                               | 365.90                                                             | 46.46                                                         | 0.00                                                                      | 100                                         | 17,280                                     | 172,800                                     | 7                                                                                           |
| InstaDapp        | 22.25                                               | 440.24                                                             | 94.62                                                         | 0.00                                                                      | 7,200                                       | 14,400                                     | 172,800                                     | 3                                                                                           |
| Lido             | ``                                                  | ``                                                                 | 8.41                                                          | ``                                                                        | ``                                          | 21,600                                     | ``                                          | ``                                                                                          |
| Maker            | ``                                                  | ``                                                                 | 20.94                                                         | ``                                                                        | ``                                          | ``                                         | ``                                          | 10                                                                                          |
| Optimism         | 35.61                                               | ∞                                                                 | 5.72                                                          | ``                                                                        | ``                                          | 259,200                                    | ``                                          | 2                                                                                           |
| Pooh             | 1.38                                                | 4,545.07                                                           | 4,203.75                                                      | 0.00                                                                      | 1                                           | 50,400                                     | 259,200                                     | 2                                                                                           |
| Radicle          | 37.22                                               | 95.61                                                              | 24.05                                                         | 25.56                                                                     | 1                                           | 17,280                                     | 172,800                                     | 3                                                                                           |
| Silo             | 26.26                                               | 1,183.54                                                           | 5.66                                                          | 0.00                                                                      | 128                                         | 21,000                                     | 172,800                                     | ``                                                                                          |
| Strike           | 70.15                                               | 39.50                                                              | 19.65                                                         | 0.00                                                                      | 1                                           | 17,280                                     | 172,800                                     | ``                                                                                          |
| Sudoswap         | 21.50                                               | 425.47                                                             | 78.18                                                         | 0.00                                                                      | 14,400                                      | 21,600                                     | ``                                          | 16                                                                                          |
| Uniswap          | 25.14                                               | 325.10                                                             | 6.55                                                          | 0.00                                                                      | 13,140                                      | 40,320                                     | 172,800                                     | ``                                                                                          |

The data above is generated from the respective blockchain of Ethereum, Layer 2s Arbitrum and Optimism. The average votes refers to an average of the previous five executed votes that were not canceled for each DAO. The available liquidity refers to the liquidity on Uniswap V2 and Uniswap V3 on Ethereum and Uniswap V3 on Arbitrum and Optimism.

## 1. DAO vulnerabilities

**a) Easy Vote Aquirement**

* **Voter apathy** : a low proportion of token holders delegate or vote themselves to makes it easier for an attacker to pass malicious proposals. In the 26 DAOs measured above, many have only around 35% participation from the delegated tokens. Pooh (https://www.tally.xyz/gov/pooh), with the lowest of around 1%, is considered to be vulnerable. However, since its relative treasury value is empty, there is little incentive for attackers to be evil through token acquiring.
* **Ample governance token liquidity** : if available liquidity in the secondary market is high, especially when higher than the threshold to create a proposal, and higher than the votes number that almost guarantee success, then this entails the possibility of buying or lending enough governance token to launch an attack. Most of the DAOs have token availability exceeds the threshold. Braintrust (https://www.usebraintrust.com/governance) and Pooh are considered to be the most vulnerable in this case, but both their relative treasury value is sufficiently low.
* **Centralization** : a large token supply only held  by a small portion of addresses can lead to majority coalition, whale activation, bribing, and other potential weaknesses. More than 10 DAOs have minimum number of addresses under 3 holding more than 50% of the delegate votes, indicating higher centralization and higher risk.

**b) Contract Code Vulnerabilities**

* **Code uncertainties** : contract code contains complicated logic and maybe unknown mechanisms that leads to risks. Also, attacks on protocols associated with a DAO can also harm the DAO. For example, Heisenberg manipulated the price oracle for MNGO, and the DAO treasury was drained. Take the Curio hack happened in March 2024 as another example. The attacker was able to grant themselves elevated voting privileges with relatively small amount of CGT tokens, and conduct delegatecall to the malicious smart contract enabling the massive token mint.
* **Insufficient configuration** : first, the delay between proposal creation and the start of the voting period must be larger than 0 to avoid flash loan attacks; second, it is also safer to have a longer voting window; third, the duration a proposal must remain in the timelock is also the longer the safer. All the DAOs analyzed have a sufficient voting period, but 10 DAOs have proposal delay of only 1 block, leading to certain risks.

**c) Large Treasury ****Value**** Incentive**

* The more value stored in the treasury, the larger is the attractiveness of an attack. Since in the aftermath of an attack, token prices are expected to plummet, the treasury value without the governace token is also measured in the table. Ampleforth has a treasury value(without governance token) five times larger than the value of the delegated votes, making it an attractive target for attacks.


## 2. **Ways of attack**

**a) Vote Control**

* **Bribing:** when voting power is highly centralized, bribing a few addresses can suffice to change a vote. It can be done by smart contract or personal contact.
* **Token control**:
  * When voter participation is low, acquiring fewer tokens can become the majority
  * When available liquidity is enough to establish a proposal or to pass a vote, the attacker can acquire sufficient tokens in the market

**b) Code Attack**

* Reentrancy and Re-vote attack
* Flash loan attack: When proposal delay is low, it is possible to use flash loans of the governance token for evil.


## 3. **Cost of attack**

* The capital required to buy the necessary proposal/voting power: the governance token price may suffer significant decline if the attack suceeded
* The loan interest if the attacker borrows the governance token
* The code design and deployment cost

First, for the token control method of attack, the estimated cost is the parameter of delegated vote, voter participation and voting configuration:

Proposal threshold + delegated vote * voter participation * 51%, or average votes, is the vote needed to pass one malicious proposal.

If being detected, proposal threshold + delegated vote * 51% is the minimum vote needed to launch and pass one malicious proposal.

Second, if the voting configuration period is short and flash loan attack is possible, such as in the case of Beanstalk, the attacker does not require access to significant funds for collateral, but only pays the fee to borrow the governance token. In the Beanstalk case, the attacker took a flash loan worth approximately \$1B, causing damages of approximately \$182M and netting a profit of around \$76M. In the 20 DAOs analyzed in the table, however, few DAOs are vulnerable to flash loan attacks because of relatively long configuration time.

Third, for code attack, maybe a relatively small amount of tokens is needed, and the cost is mostly based on smart contract design and deployment.

# b) For vulnerable DAOs, estimate and describe the potential benefit for the attacker i.e., how much of the DAO’s treasury is at risk of being stolen? (it can also be a parameter change)

Since after an effective attack, the price of the governance token is likely to plummet, so the benefit for the attacker mainly lies in the treasury value without the governance token.

Take Ampleforth as an example, according to the Ampleforth treasury address(`0x223592a191ECfC7FDC38a9256c3BD96E771539A9`),  the DAO treasury wallet holds around 5.3 million governance token FORTH, 10 milliom protocol token AMPL and another around 1 million value of other tokens including Uniswap LP tokens, Graph token etc. If the attacker takes full control of the treasury, assuming the price of FORTH drops to zero, there is still around 10 million gross revenue for the attacker.
